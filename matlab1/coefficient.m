% 这段代码用于对不同腿长下腿部的参数进行拟合
%% 输入测量得到的数据（l0单位为m,l_wl单位为m,l_bl单位为m，I_ll单位为kg*m^2）
l0_mm = [160.00, 170.00, 180.00, 190.00, 200.00, 210.00, 220.00, 230.00, 240.00, 250.00, ...
         260.00, 270.00, 280.00, 290.00, 300.00, 310.00, 320.00, 330.00, 340.00, 350.00, ...
         360.00, 370.00, 380.00, 390.00, 400.00, 410.00]';
l_wl_mm = [87.00, 91.00, 94.60, 98.60, 102.60, 106.90, 111.20, 115.60, 120.00, 124.60, ...
           129.20, 133.90, 138.70, 143.50, 148.30, 153.20, 158.10, 163.00, 168.00, 173.10, ...
           178.10, 183.20, 188.30, 193.40, 198.50, 203.70]';
l_bl_mm = [73, 79, 85.4, 91.4, 97.4, 103.1, 108.8, 114.4, 120, 125.4, ...
           130.8, 136.1, 141.3, 146.5, 151.7, 156.8, 161.9, 167, 172, 176.9, ...
           181.9, 186.8, 191.7, 196.6, 201.5, 206.3]';
I_ll = [0.01527, 0.015581, 0.015868, 0.016212, 0.016574, 0.016953, 0.017349, 0.017807, 0.01824, 0.018646, ...
        0.01916, 0.019647, 0.020152, 0.020676, 0.021217, 0.021777, 0.022355, 0.022951, 0.023507, 0.024199, ...
        0.02485, 0.02552, 0.026207, 0.026914, 0.027638, 0.028305]';

% 单位转换：从毫米转换为米
l0 = l0_mm / 1000;      % 转换为米
l_wl = l_wl_mm / 1000;  % 转换为米
l_bl = l_bl_mm / 1000;  % 转换为米

%% 多项式拟合
%给定拟合的阶数
degree = 1;

% 拟合 l_w1 关于 l0
p_l_wl = polyfit(l0, l_wl, degree);
fitted_l_wl = polyval(p_l_wl, l0);

% 拟合 l_b1 关于 l0
p_l_bl = polyfit(l0, l_bl, degree);
fitted_l_bl = polyval(p_l_bl, l0);

% 拟合 I_11 关于 l0
p_I_ll = polyfit(l0, I_ll, degree);
fitted_I_ll = polyval(p_I_ll, l0);
% 返回拟合系数
fprintf('拟合系数 for l_wl: ');
disp(p_l_wl);
fprintf('拟合系数 for l_bl: ');
disp(p_l_bl);
fprintf('拟合系数 for I_ll: ');
disp(p_I_ll);

%% 绘制图像


% 绘制拟合结果与真实值的对比
figure;

% 1. l_w1 的拟合结果
subplot(3,1,1);
plot(l0, l_wl, 'o', 'DisplayName', '真实值');
hold on;
plot(l0, fitted_l_wl, '-', 'DisplayName', '拟合值');
xlabel('l0 (m)');
ylabel('l_wl (m)');
title('l_wl 关于 l0 的拟合');
legend;
grid on;

% 2. l_b1 的拟合结果
subplot(3,1,2);
plot(l0, l_bl, 'o', 'DisplayName', '真实值');
hold on;
plot(l0, fitted_l_bl, '-', 'DisplayName', '拟合值');
xlabel('l0 (m)');
ylabel('l_bl (m)');
title('l_bl 关于 l0 的拟合');
legend;
grid on;

% 3. I_11 的拟合结果
subplot(3,1,3);
plot(l0, I_11, 'o', 'DisplayName', '真实值');
hold on;
plot(l0, fitted_I_ll, '-', 'DisplayName', '拟合值');
xlabel('l0 (m)');
ylabel('I_ll (kg*m^2)');
title('I_ll 关于 l0 的拟合');
legend;
grid on;

% 调整布局
sgtitle('拟合结果与真实值对比');